# **7. Ejercicios para practicar DataStore**

Ahora que ya entiendes cÃ³mo funciona cada lÃ­nea del cÃ³digo de **`SettingsDataStore`**, te propongo **tres ejercicios prÃ¡cticos** para reforzar tu aprendizaje.

ðŸ“Œ **Estructura de los ejercicios:**  
âœ… **Ejercicio 1 - Guardar y leer un valor booleano** (Nivel bÃ¡sico)  
âœ… **Ejercicio 2 - Almacenar y recuperar mÃºltiples preferencias** (Nivel intermedio)  
âœ… **Ejercicio 3 - Implementar DataStore en ViewModel y observar cambios en UI** (Nivel avanzado)

---

## **âœ… [[Ejercicio 1 - Guardar y leer un valor booleano]]** (Nivel bÃ¡sico)

ðŸ“Œ **Objetivo:** Implementa un DataStore para guardar y recuperar una preferencia **"modo aviÃ³n activado" (`airplane_mode`)**.

### **ðŸ”¹ Pasos a seguir:**

1. **Crea una clase `AirplaneModeDataStore`.**
2. **Define una clave** `AIRPLANE_MODE_KEY`.
3. **Implementa un mÃ©todo `saveAirplaneMode(isEnabled: Boolean)`** que guarde el estado del modo aviÃ³n en DataStore.
4. **Implementa un `Flow` llamado `airplaneModeFlow`** que devuelva el valor almacenado.
5. **Prueba llamando a la funciÃ³n de guardado y lectura en una `Activity` o `ViewModel`.**

ðŸ”¹ **Pista:**

- Usa `booleanPreferencesKey("airplane_mode")` para definir la clave.
- La estructura serÃ¡ **idÃ©ntica a `SettingsDataStore`**, pero con otro nombre de clave.

---

## **âœ… [[Ejercicio 2 - Guardar y recuperar mÃºltiples preferencias]]** (Nivel intermedio)

ðŸ“Œ **Objetivo:** Modifica la clase `SettingsDataStore` para permitir guardar y leer **dos preferencias adicionales**:

1. **Idioma de la aplicaciÃ³n (`language`)** (tipo `String`)
2. **TamaÃ±o de fuente (`font_size`)** (tipo `Int`)

### **ðŸ”¹ Pasos a seguir:**

1. **Agrega dos claves adicionales** en `companion object`:
    - `LANGUAGE_KEY = stringPreferencesKey("language")`
    - `FONT_SIZE_KEY = intPreferencesKey("font_size")`
2. **Modifica `SettingsDataStore`** para:
    - Implementar mÃ©todos `saveLanguage(String)` y `saveFontSize(Int)`.
    - Implementar `languageFlow` y `fontSizeFlow` para recuperar cada valor.
3. **Prueba tu implementaciÃ³n** llamando a los mÃ©todos desde una `Activity` o `ViewModel`.

ðŸ”¹ **Pista:**

- `stringPreferencesKey("language")` para almacenar una `String`.
- `intPreferencesKey("font_size")` para almacenar un `Int`.

âœ… **Â¿Bonus?**  
ðŸ”¹ Modifica `savePreferences()` para **guardar los tres valores juntos** en una sola transacciÃ³n atÃ³mica.

---

## **âœ… [[Ejercicio 3 - Implementar DataStore en ViewModel y observar cambios en la UI]]** (Nivel avanzado)

ðŸ“Œ **Objetivo:** Usa `SettingsDataStore` en un `ViewModel` para que la UI de la app **cambie automÃ¡ticamente cuando el usuario modifica las preferencias**.

### **ðŸ”¹ Pasos a seguir:**

1. **Crea un `ViewModel` llamado `SettingsViewModel`**.
2. **En el `ViewModel`, usa `SettingsDataStore`** para obtener `themeFlow`, `languageFlow` y `fontSizeFlow`.
3. **Convierte cada `Flow` en `LiveData`** para que pueda observarse desde la UI.
4. **Implementa mÃ©todos `toggleDarkMode()`, `setLanguage()`, `setFontSize()`** para modificar cada preferencia.
5. **En una `Activity` o `Fragment`**, observa los cambios en `LiveData` y actualiza la interfaz de usuario cuando cambien.

ðŸ”¹ **Pista:**

- Usa `asLiveData()` en el `ViewModel` para convertir `Flow` en `LiveData`.
- En la `Activity`, usa `observe {}` para reaccionar a los cambios de configuraciÃ³n.

âœ… **Â¿Bonus?**  
ðŸ”¹ **Agrega un `Switch` en la UI** que permita activar/desactivar el **modo oscuro** y guarde la preferencia en DataStore.

---

# **ðŸ”¹ Â¿CÃ³mo practicar estos ejercicios?**

âœ” Empieza con **el ejercicio 1** y asegÃºrate de que puedes **guardar y leer datos en DataStore**.  
âœ” Luego, en **el ejercicio 2**, **maneja mÃºltiples preferencias** y observa cÃ³mo se organizan en el archivo de DataStore.  
âœ” Finalmente, en **el ejercicio 3**, usa **ViewModel y LiveData** para aplicar lo aprendido en un entorno real con UI.

---

ðŸš€ **ConclusiÃ³n:**

- Estos ejercicios te ayudarÃ¡n a **entender DataStore en profundidad** y aplicarlo en un proyecto real.
- **Si necesitas ejemplos de soluciÃ³n o quieres probar con pruebas unitarias, dime y te ayudo.** ðŸ’ª
