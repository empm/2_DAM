```kotlin
class SettingsDataStoreTest {  
  
    private lateinit var settingsDataStore: SettingsDataStore  
    private val context: Context = ApplicationProvider.getApplicationContext()  
  
    @Before  
    fun setup() {  
        settingsDataStore = SettingsDataStore(context)  
    }  
  
    @Test  
    fun testSaveAndRetrieveLanguage() = runBlocking {  
        val testLanguage = "es"  
  
        settingsDataStore.saveLanguage(testLanguage)  
  
        val retrievedLanguage = settingsDataStore.languageFlow.first()  
        assertEquals(testLanguage, retrievedLanguage)  
    }  
  
}
```


### **ğŸ“Œ ExplicaciÃ³n del test `SettingsDataStoreTest`**

Este test comprueba que **DataStore puede guardar y recuperar datos correctamente**.  
Se ejecuta en **un entorno de prueba** sin necesidad de una `Activity` real.

ğŸ“Œ **ExplicaciÃ³n de cada parte del cÃ³digo:**

#### **1ï¸âƒ£ Variables de prueba**

```kotlin
private lateinit var settingsDataStore: SettingsDataStore  
private val context: Context = ApplicationProvider.getApplicationContext()  
```

âœ” `lateinit var settingsDataStore` â†’ Se declara pero no se inicializa hasta `setup()`.  
âœ” `context: Context = ApplicationProvider.getApplicationContext()` â†’ Obtiene un `Context` para los tests.

#### **2ï¸âƒ£ InicializaciÃ³n antes de cada test (`@Before`)**

```kotlin
@Before  
fun setup() {  
    settingsDataStore = SettingsDataStore(context)  
}
```

âœ” `@Before` â†’ Se ejecuta antes de cada prueba.  
âœ” Crea una instancia de `SettingsDataStore` para usar en los tests.

#### **3ï¸âƒ£ Test de escritura y lectura en DataStore**

```kotlin
@Test  
fun testSaveAndRetrieveLanguage() = runBlocking {  
    val testLanguage = "es"  

    settingsDataStore.saveLanguage(testLanguage)  

    val retrievedLanguage = settingsDataStore.languageFlow.first()  
    assertEquals(testLanguage, retrievedLanguage)  
}
```

âœ” **Guarda el idioma "es" en DataStore**.  
âœ” **Lee el idioma guardado** con `.first()`.  
âœ” **Comprueba que el valor leÃ­do es correcto** con `assertEquals()`.

---

## **ğŸ“Œ Ejemplo 1: Test para guardar y recuperar el modo oscuro**

Este test **comprueba si DataStore guarda correctamente la preferencia de modo oscuro**.

```kotlin
@Test  
fun testSaveAndRetrieveDarkMode() = runBlocking {  
    val testDarkMode = true  

    settingsDataStore.saveThemePreference(testDarkMode)  

    val retrievedDarkMode = settingsDataStore.themeFlow.first()  
    assertEquals(testDarkMode, retrievedDarkMode)  
}
```

ğŸ“Œ **ExplicaciÃ³n:**  
âœ” **Guarda `true` como preferencia del modo oscuro.**  
âœ” **Lee el valor almacenado y verifica que sea `true`.**

âœ… **Si el test pasa, significa que DataStore almacena y devuelve correctamente el valor del tema oscuro.**

---

## **ğŸ“Œ Ejemplo 2: Test para guardar y recuperar el estado del modo aviÃ³n**

Este test **comprueba si DataStore guarda correctamente la preferencia del modo aviÃ³n**.

```kotlin
@Test  
fun testSaveAndRetrieveAirplaneMode() = runBlocking {  
    val testAirplaneMode = false  

    settingsDataStore.saveAirplaneMode(testAirplaneMode)  

    val retrievedAirplaneMode = settingsDataStore.airplaneModeFlow.first()  
    assertEquals(testAirplaneMode, retrievedAirplaneMode)  
}
```

ğŸ“Œ **ExplicaciÃ³n:**  
âœ” **Guarda `false` como preferencia del modo aviÃ³n.**  
âœ” **Lee el valor almacenado y verifica que sea `false`.**

âœ… **Si el test pasa, significa que DataStore almacena y devuelve correctamente el estado del modo aviÃ³n.**

---

## **ğŸ“Œ Resumen**

|**Test**|**Propiedad en DataStore**|**MÃ©todo de guardado**|**MÃ©todo de lectura**|
|---|---|---|---|
|Idioma|`languageFlow`|`saveLanguage()`|`.first()`|
|Modo oscuro|`themeFlow`|`saveThemePreference()`|`.first()`|
|Modo aviÃ³n|`airplaneModeFlow`|`saveAirplaneMode()`|`.first()`|
